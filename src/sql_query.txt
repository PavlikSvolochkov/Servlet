CREATE OR REPLACE PROCEDURE NEW_CLIENT (NAME IN VARCHAR2, SURNAME IN VARCHAR2, DATEOFBIRTH IN DATE)
AS id_client CARDS.ID_CLIENT%TYPE;
BEGIN  
  INSERT INTO CLIENTS(NAME, SURNAME, DATEOFBIRTH) VALUES(NAME, SURNAME, DATEOFBIRTH) RETURNING ID INTO id_client;
  SYS.DBMS_OUTPUT.PUT_LINE('CLIENT_ID');
  INSERT INTO CARDS(CARD, ID_CLIENT) VALUES('0000001112', id_client);
  INSERT INTO ACCOUNTS(ACCOUNT, ID_CLIENT) VALUES('1112', id_client);
END NEW_CLIENT;

SELECT CLIENTS.ID, CLIENTS.NAME, CLIENTS.SURNAME, CLIENTS.DATEOFBIRTH, CARDS.CARD, ACCOUNTS.ACCOUNT FROM CLIENTS
RIGHT OUTER JOIN CARDS ON (CLIENTS.ID = CARDS.ID_CLIENT)
RIGHT OUTER JOIN ACCOUNTS ON (CLIENTS.ID = ACCOUNTS.ID_CLIENT);



create or replace type cards_tab is table of INT;

FOR i IN cardst.FIRST .. cardst.LAST
  LOOP
    SELECT MAX(ID) INTO LASTCARDID FROM CARDS;
    INSERT INTO CARDS(ID, CARD, ID_CLIENT) VALUES(LASTCARDID+1, cardst(i), id_client);
  END LOOP;





--âûçîâ ïðîöåäóðû (çàåáåøåíî-ðàúåáåøåííîé)
BEGIN NEW_CLIENT('vas', 'svin', cards_tab(0000001114,0000001113)); END;

-----çàåáåøèë
create or replace PROCEDURE NEW_CLIENT (NAME IN VARCHAR2, SURNAME IN VARCHAR2, cardst IN cards_tab)
AS id_client CARDS.ID_CLIENT%TYPE;
LASTID INT;
LASTCARDID INT;
LASTACCID INT;

BEGIN
  
  SELECT MAX(ID) INTO LASTID FROM CLIENTS1 ;
  
  SELECT MAX(ID) INTO LASTACCID FROM ACCOUNTS;
  INSERT INTO CLIENTS1(ID, NAME, SURNAME) VALUES(LASTID+1, NAME, SURNAME) RETURNING ID INTO id_client;
  FOR i IN cardst.FIRST .. cardst.LAST
  LOOP
    SELECT MAX(ID) INTO LASTCARDID FROM CARDS;
    INSERT INTO CARDS(ID, CARD, ID_CLIENT) VALUES(LASTCARDID+1, cardst(i), id_client);
  END LOOP;
  --INSERT INTO CARDS(ID, CARD, ID_CLIENT) VALUES(LASTCARDID+1, '0000001112', id_client);
  INSERT INTO ACCOUNTS(ID, ACCOUNT, ID_CLIENTS) VALUES(LASTACCID+1, '1112', id_client);
END NEW_CLIENT;
-----ðàçúåáåøèë